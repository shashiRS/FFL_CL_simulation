# VSP_Powertrain
## Powertrain surrogate model

## Getting Access & Permissions
Every user in the ADAS GitHub Team has read access. To get write access, please ask one of the following:  
Kaustub Ragunathan kaustub.ragunathan@continental.com,  
Thomas Meißner thomas.meissner@continental.com  
to add you to the GitHub team that has write access.

## Responsible
Kaustub Ragunathan kaustub.ragunathan@continental.com,  
Thomas Meißner thomas.meissner@continental.com

##Documentation:
https://confluence-adas.zone2.agileci.conti.de/x/hhKnB

## Requirements:
```
CarMaker 10.2.X (under C:\LegacyApp\IPG)
```

To build the project with cmake use the command

    cmake -A x64
	
to get a 64-bit compatible Visual Studio Solution. Add the option "-DMoCo_Brake=ON" to also build MoCo_Brake model. Building only the latter is not supported.
You can build the project with Visual Studio or use the command

    cmake --build .
	
If you call cmake from a subdirectory (e.g. you create a build folder on the top level) you need to adapt the command accordingly, e.g.

    cmake .. -A x64
	
To build the project for Linux:
	create a build folder in the root folder (VSP_SEF_Powertrain)
	cd build
	cmake ..
	make
	
## To build the project for BRICKS (local build)

	- release
	py ./scripts/cip.py build --variant generic --platform vs2017
	
	- debug
	py ./scripts/cip.py build --variant generic --platform vs2017_debug

## Usage Instructions

1. The OCTAGONEngine model makes use of the ECU Load generated by CarMaker and calculate appropriate engine torque
2. In case external target engine torque needs to be provided, it should be provided to the signal _PT.Control.Engine.Trq_trg_ (look at the example TestRun _DVA_Tests_). Based on this value, CarMaker generates an appropriate ECU Load which is then used in the engine model to generate engine output torque. 
 > :warning: Do not forget to release the signals modified by DVA  at the end of the TestRun
3. The parameterization for the model can be found under _tests/carmaker/Data/Misc_ for VW Passat and BMW X5

## CarMaker signals for Analysis
The following usual CarMaker default signals (among others) can be used for analysis:
> 1. PT.ECU.Load
> 2. PT.Engine.Trq
> 3. PT.Engine.rotv
> 4. PT.Control.Engine.Trq_trg

Two additional signals are added to the list from the OCTAGONEngine model. These are:
> 1. PT.Engine.MaxTrq  // Maximum engine torque available for a given engine rpm
> 2. PT.Engine.MinTrq  // Minimum engine torque available for a given engine rpm

The signal _PT.Engine.MinTrq_ can also take positive values for example during the idle speed mode when the Idle Speed Controller is requesting positive torque to keep the engine from stalling.
